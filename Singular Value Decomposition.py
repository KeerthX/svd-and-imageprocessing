import numpy as np
import matplotlib.pyplot as plt

x = np.array([[0,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
            [0,0,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
            [2,0,0,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
            [1,2,0,0,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
            [1,1,2,0,0,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1],
            [1,1,1,2,0,0,0,2,1,1,1,1,1,1,1,1,1,1,1,1],
            [1,1,1,1,2,0,0,0,2,1,1,1,1,1,1,1,1,1,1,1],
            [1,1,1,1,1,2,0,0,0,2,1,1,1,1,1,1,1,1,1,2],
            [1,1,1,1,1,1,2,0,0,0,2,1,1,1,1,1,1,1,2,2],
            [1,1,1,1,1,1,1,2,0,0,0,2,1,1,1,1,1,2,2,2],
            [1,1,1,1,1,1,1,1,2,0,0,0,2,1,1,1,2,2,2,3],
            [1,1,1,1,1,1,1,1,1,2,0,0,0,2,1,2,2,2,3,1],
            [1,1,1,1,1,1,1,1,1,1,2,0,0,0,2,2,2,3,1,1],
            [1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,2,3,1,1,1],
            [1,1,1,1,1,1,1,1,1,1,1,1,2,0,0,2,3,1,1,1],
            [1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,3,3,1,1],
            [1,1,1,1,1,1,1,1,1,1,2,2,2,3,3,3,3,3,3,1],
            [1,1,1,1,1,1,1,1,1,2,2,2,3,1,1,3,3,3,3,3],
            [1,1,1,1,1,1,1,1,2,2,2,3,1,1,1,1,3,3,3,3],
            [1,1,1,1,1,1,1,2,2,2,3,1,1,1,1,1,1,3,3,3],])
w = np.absolute(x)
def svdiezer(n):
    
    
    U,s,VT=np.linalg.svd(x)
    

    for i in range (n,20):
        for j in range (n,20):
            U[i][j] = 0
            VT[j][i] = 0
            VT[i][i] = 0
    r=U@np.diag(s)@VT
    return r

for n in range (0,21):
    d = svdiezer(n)
    c = np.absolute(d)
    print(n)
    plt.imshow(d)
    plt.show()


plt.plot(w,c)
plt.show()
